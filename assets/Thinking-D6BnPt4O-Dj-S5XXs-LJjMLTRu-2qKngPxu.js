import{S as K,K as R,Z as U,k as t,D,f as j,M as B,E as h,F as l,a as i,z as a,G as u,b as o,n as c,m as v,r as f,V as S,y as $,$ as H,s as J}from"./index-CAWiLVoK.js";import{o as W}from"./record-AmF9OWS7-D1muATjG-D2PamTer-fFwh1RM7.js";const X={class:"thinking"},Y={class:"container"},ss={class:"thinking-header"},es={class:"thinking-content"},as={class:"questions-section"},ns={key:0,class:"loading"},ts={key:1,class:"no-questions"},ls={key:2,class:"current-question"},is={class:"question-navigator"},us={class:"question-list"},os=["onClick"],rs={class:"question-nav-number"},cs={class:"question-nav-content"},vs={class:"question-item"},ds={class:"question-header"},gs={class:"question-number"},ps={class:"question-content"},ms={key:0,class:"counter-answer"},ks={class:"counter-answer-content"},ys={class:"question-navigation"},hs={key:3,class:"suggestion-prompt"},ws={class:"prompt-actions"},qs={key:4,class:"suggestions-section"},fs={class:"suggestions-list"},bs={class:"suggestion-number"},_s={class:"suggestion-content"},Cs={class:"actions-section"},As={__name:"Thinking",setup(Qs){const p=R(),s=U(),x=W(),m=t(()=>s.currentTopic),w=t(()=>s.currentTopicType),T=t(()=>s.questions),I=t(()=>s.answers),b=t(()=>s.currentQuestion),q=t(()=>s.currentQuestionIndex),k=t(()=>s.isLoading),_=t(()=>s.hasNextQuestion);t(()=>s.isLastQuestion);const V=t(()=>s.showSuggestionPrompt),C=t(()=>s.suggestions),A=t(()=>s.counterAnswer),n=D(""),Q=async()=>{if(!m.value){p.push("/");return}try{await s.generateFirstQuestion(m.value,w.value)}catch(y){console.error("生成第一个问题失败:",y),alert("生成问题失败，请返回首页重新尝试"),p.push("/")}},E=async()=>{n.value.trim()&&(await s.generateNextQuestion(n.value),n.value="")},z=()=>{s.goToPreviousQuestion(),n.value=s.currentAnswer||""},F=y=>{n.value.trim()&&s.saveCurrentAnswer(n.value),s.currentQuestionIndex=y,n.value=s.currentAnswer||""},L=()=>{s.saveCurrentAnswer(n.value),s.saveSession()},M=async()=>{await s.generateSuggestions()},N=()=>{s.skipSuggestions()},O=()=>{s.questions.length!==0&&(x.addRecord({topic:m.value,topicType:w.value,questions:s.questions,answers:s.answers}),p.push("/records"))};return j(async()=>{if(s.restoreSession(),!m.value){p.push("/");return}s.questions.length===0&&await Q(),n.value=s.currentAnswer||""}),B(()=>{s.saveSession()}),(y,e)=>{const P=h("el-tag"),Z=h("el-skeleton"),d=h("el-button"),G=h("el-input");return i(),l("div",X,[a("div",Y,[a("div",ss,[a("h2",null,o(m.value),1),u(P,{size:"small"},{default:c(()=>[v(o(w.value),1)]),_:1})]),a("div",es,[a("div",as,[e[11]||(e[11]=a("h3",null,"苏格拉底的提问",-1)),k.value?(i(),l("div",ns,[u(Z,{rows:3,animated:""})])):b.value?(i(),l("div",ls,[a("div",is,[e[4]||(e[4]=a("h4",null,"问题导航",-1)),a("div",us,[(i(!0),l(S,null,$(T.value,(g,r)=>(i(),l("div",{key:r,class:H(["question-nav-item",{active:r===q.value,answered:I.value[r]}]),onClick:Ss=>F(r)},[a("span",rs,o(r+1),1),a("span",cs,o(g.substring(0,30))+"...",1)],10,os))),128))])]),a("div",vs,[a("div",ds,[a("div",gs,o(q.value+1),1),a("div",ps,o(b.value),1)]),A.value?(i(),l("div",ms,[e[5]||(e[5]=a("div",{class:"counter-answer-label"},"AI回答：",-1)),a("div",ks,o(A.value),1)])):f("",!0),u(G,{modelValue:n.value,"onUpdate:modelValue":e[0]||(e[0]=g=>n.value=g),placeholder:"请输入您的回答...",type:"textarea",rows:3,resize:"none",onInput:L},null,8,["modelValue"])]),a("div",ys,[u(d,{type:"default",onClick:z,disabled:q.value===0||k.value},{default:c(()=>[...e[6]||(e[6]=[v(" 上一个问题 ",-1)])]),_:1},8,["disabled"]),u(d,{type:"primary",onClick:E,loading:k.value,disabled:!n.value.trim()&&_.value||k.value},{default:c(()=>[v(o(_.value?"下一个问题":"完成思考"),1)]),_:1},8,["loading","disabled"])])])):(i(),l("div",ts,[e[3]||(e[3]=a("p",null,'暂无提问，请点击"开始思考"按钮',-1)),u(d,{type:"primary",onClick:Q},{default:c(()=>[...e[2]||(e[2]=[v("开始思考",-1)])]),_:1})])),V.value?(i(),l("div",hs,[e[9]||(e[9]=a("div",{class:"prompt-content"},[a("p",null,"您已经完成了所有问题的回答。"),a("p",null,"是否想听一听我的建议？")],-1)),a("div",ws,[u(d,{type:"primary",onClick:M,loading:k.value},{default:c(()=>[...e[7]||(e[7]=[v(" 想听建议 ",-1)])]),_:1},8,["loading"]),u(d,{onClick:N},{default:c(()=>[...e[8]||(e[8]=[v("不需要，谢谢",-1)])]),_:1})])])):f("",!0),C.value.length>0?(i(),l("div",qs,[e[10]||(e[10]=a("h4",null,"AI建议",-1)),a("div",fs,[(i(!0),l(S,null,$(C.value,(g,r)=>(i(),l("div",{key:r,class:"suggestion-item"},[a("div",bs,o(r+1),1),a("div",_s,o(g),1)]))),128))])])):f("",!0)]),a("div",Cs,[u(d,{onClick:O},{default:c(()=>[...e[12]||(e[12]=[v("保存记录",-1)])]),_:1}),u(d,{onClick:e[1]||(e[1]=g=>J(p).back())},{default:c(()=>[...e[13]||(e[13]=[v("返回首页",-1)])]),_:1})])])])])}}},Ts=K(As,[["__scopeId","data-v-3ac511a7"]]);export{Ts as default};
